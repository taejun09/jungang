<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>군산중앙고등학교 기숙사</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link rel="icon" type="image/png" href="https://taejun09.github.io/jungang/assets/image/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="https://taejun09.github.io/jungang/assets/image/favicon.svg" />
<link rel="shortcut icon" href="https://taejun09.github.io/jungang/assets/image/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="https://taejun09.github.io/jungang/assets/image/" />
<meta name="apple-mobile-web-app-title" content="군산중앙고 기숙사" />
<link rel="manifest" href="https://taejun09.github.io/jungang/site.webmanifest" />
<link href="jungang-main.css" rel="stylesheet" type="text/css"/>
</head>


<body class="!bg-[#101012] text-white">
    <div class="max-w-sm mx-auto bg-gray-900 min-h-screen p-4">
 <!-- 헤더 -->
 <div class="flex justify-between items-center mb-6">
    <div class="flex items-center space-x-3">
        <img src="https://taejun09.github.io/jungang/assets/image/jungang-main_logo.png" alt="중앙중 로고" class="w-10 h-10 rounded-full">
        <span class="text-[#D9D9D9] text-lg font-semibold tracking-wide">군산중앙고 기숙사</span>
    </div>
    <div class="flex space-x-4">
        <!-- 학생이름 표시 -->
        <span id="welcomeUser" class="bg-[#363740] text-[#BFBFBF] px-4 py-2 rounded-lg">
            로딩 중...
        </span>        
    </div>
</div>
<script>
    (function() {
        try {
            // 로그인 정보 가져오기
            const loggedInUser = sessionStorage.getItem("loggedInUser");

            if (!loggedInUser) {
                // 로그인 정보가 없으면 즉시 로그인 페이지로 이동
                window.location.replace("https://taejun09.github.io/jungang/login/");
            } else {
                // 로그인된 경우 페이지 표시
                document.body.style.display = "block";
                document.getElementById("welcomeUser").innerText = `${loggedInUser}님`;
            }
        } catch (error) {
            console.error("로그인 확인 중 오류 발생:", error);
            window.location.replace("https://taejun09.github.io/jungang/login/");
        }
    })();
</script>

<script>
    // 노트북(1024px) 이상에서만 팝업 표시 및 블러 처리
    if (window.innerWidth >= 1024) {
        document.getElementById("overlay").style.display = "block";
        document.getElementById("pc-popup").style.display = "block";
        document.body.style.overflow = "hidden"; // 스크롤 방지
    }
</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const mealPopup = document.getElementById("meal-popup");
        const closeMealPopupBtn = document.getElementById("close-meal-popup");
        const mealInfoBtn = document.getElementById("meal-info-btn");
        const mealPopupContent = document.getElementById("meal-popup-content");

        const breakfastEl = document.getElementById("breakfast");
        const lunchEl = document.getElementById("lunch");
        const dinnerEl = document.getElementById("dinner");

        const apiKey = "fb6483a86ea640fc8fbf761c34c66f62"; 
        const schoolCode = "8321116"; 
        const districtCode = "P10"; 

        function getToday() {
            const today = new Date();
            return today.toISOString().split("T")[0].replace(/-/g, ""); 
        }

        async function fetchMealInfo() {
            const today = getToday();
            const apiUrl = `https://open.neis.go.kr/hub/mealServiceDietInfo?KEY=${apiKey}&Type=json&ATPT_OFCDC_SC_CODE=${districtCode}&SD_SCHUL_CODE=${schoolCode}&MLSV_YMD=${today}`;

            try {
                const response = await fetch(apiUrl);
                const data = await response.json();

                if (data.mealServiceDietInfo) {
                    const meals = data.mealServiceDietInfo[1].row;

                    let breakfast = "없음";
                    let lunch = "없음";
                    let dinner = "없음";

                    meals.forEach(meal => {
                        const mealType = meal.MMEAL_SC_NM;
                        const menu = meal.DDISH_NM.replace(/<br\/>/g, ", ");

                        if (mealType === "조식") breakfast = menu;
                        if (mealType === "중식") lunch = menu;
                        if (mealType === "석식") dinner = menu;
                    });

                    breakfastEl.innerText = breakfast;
                    lunchEl.innerText = lunch;
                    dinnerEl.innerText = dinner;
                } else {
                    breakfastEl.innerText = "식단 정보 없음";
                    lunchEl.innerText = "식단 정보 없음";
                    dinnerEl.innerText = "식단 정보 없음";
                }
            } catch (error) {
                console.error("식단 정보를 가져오는 중 오류 발생:", error);
                breakfastEl.innerText = "오류 발생";
                lunchEl.innerText = "오류 발생";
                dinnerEl.innerText = "오류 발생";
            }
        }

        mealInfoBtn.addEventListener("click", function (event) {
            event.preventDefault(); 
            mealPopup.classList.remove("hidden");
            fetchMealInfo();
            updateLastClick("meal-info");
        });

        closeMealPopupBtn.addEventListener("click", function () {
            mealPopup.classList.add("hidden");
        });

        mealPopup.addEventListener("click", function (event) {
            if (!mealPopupContent.contains(event.target)) {
                mealPopup.classList.add("hidden");
            }
        });

        function updateLastClick(key) {
            const timestamp = Date.now();
            localStorage.setItem(`lastClick-${key}`, timestamp);
            updateLastClickTimes();
        }

        function timeAgo(timestamp) {
            const now = new Date();
            const diff = Math.floor((now - timestamp) / 1000); 

            if (diff < 60) return `${diff}초 전`;
            if (diff < 3600) return `${Math.floor(diff / 60)}분 전`;
            if (diff < 86400) return `${Math.floor(diff / 3600)}시간 전`;
            if (diff < 2592000) return `${Math.floor(diff / 86400)}일 전`;
            return `${Math.floor(diff / 2592000)}개월 전`;
        }

        function updateLastClickTimes() {
            document.querySelectorAll(".grid-item").forEach(item => {
                const key = item.getAttribute("data-key");
                const lastClickTime = localStorage.getItem(`lastClick-${key}`);

                if (lastClickTime) {
                    const timeText = timeAgo(new Date(parseInt(lastClickTime)));
                    document.getElementById(`last-click-${key}`).textContent = timeText;
                } else {
                    document.getElementById(`last-click-${key}`).textContent = "기록 없음";
                }
            });
        }

        document.querySelectorAll(".grid-item").forEach(item => {
            item.addEventListener("click", function () {
                const key = item.getAttribute("data-key");
                updateLastClick(key);
            });
        });

        updateLastClickTimes();
    });
</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const reportPopup = document.getElementById("report-popup");
        const closeReportPopupBtn = document.getElementById("close-report-popup");
        const reportBtn = document.getElementById("report-btn");
        const reportPopupContent = document.getElementById("report-popup-content");
        const reportText = document.getElementById("report-text");
        const submitReportBtn = document.getElementById("submit-report");
        const reportCategory = document.getElementById("report-category");
        const customAlert = document.getElementById("custom-alert");
        const customAlertMessage = document.getElementById("custom-alert-message");

        function showAlert(message) {
            customAlertMessage.textContent = message;
            customAlert.classList.remove("hidden");
            setTimeout(() => {
                customAlert.classList.add("hidden");
            }, 3000);
        }

        reportBtn.addEventListener("click", function (event) {
            event.preventDefault();
            reportPopup.classList.remove("hidden");
        });

        closeReportPopupBtn.addEventListener("click", function () {
            reportPopup.classList.add("hidden");
        });

        reportPopup.addEventListener("click", function (event) {
            if (!reportPopupContent.contains(event.target)) {
                reportPopup.classList.add("hidden");
            }
        });

        reportCategory.addEventListener("change", function () {
            if (reportCategory.value === "기타") {
                reportText.classList.remove("hidden");
            } else {
                reportText.classList.add("hidden");
            }
        });

        submitReportBtn.addEventListener("click", async function () {
            const category = reportCategory.value;
            const reportContent = reportText.value.trim();

            if (!category) {
                showAlert("카테고리를 선택해주세요.");
                return;
            }

            if (category === "기타" && !reportContent) {
                showAlert("고장 내용을 입력해주세요.");
                return;
            }

            const webhookUrl = "https://discord.com/api/webhooks/1350727157214871612/4cIG2DR-1MqC6hen4TjarIBSlaZ18OrelmBxQVK61hzGtiub-CBBkOcupK-7rjrG26pY";
            const payload = {
                embeds: [{
                    title: "📢 고장 신고 접수",
                    color: 15158332,
                    fields: [
                        { name: "카테고리", value: category, inline: true },
                        { name: "내용", value: category === "기타" ? reportContent : "(내용 없음)", inline: false }
                    ],
                    timestamp: new Date().toISOString()
                }]
            };

            try {
                await fetch(webhookUrl, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(payload)
                });

                showAlert("신고가 접수되었습니다.");
                reportPopup.classList.add("hidden");
                reportCategory.value = "";
                reportText.value = "";
                reportText.classList.add("hidden");
            } catch (error) {
                console.error("전송 오류:", error);
                showAlert("전송 과정에서 문제가 발생했어요.");
            }
        });
    });
</script>

<script>
    document.getElementById('closePopup').addEventListener('click', function() {
        document.getElementById('popup').classList.add('hidden');
    });
    
    function closePopup(event) {
        if (event.target.id === 'popup') {
            document.getElementById('popup').classList.add('hidden');
        }
    }
</script>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const popup = document.getElementById("popup");
    const closePopupBtn = document.getElementById("closePopup");
    const submitBtn = document.getElementById("submitRequest");
    const popupTitle = document.getElementById("popupTitle");
    const dateInput = document.getElementById("date");
    const timeInput = document.getElementById("time");
    const teacherInput = document.getElementById("teacher");
    const reasonInput = document.getElementById("reason");
    const discordWebhookUrl = "https://discord.com/api/webhooks/1350619474730029066/2ktapgJj0EbBureDTrKABC2CieIxDOXxcxWxx-fmu34iFyw3KFyYdnI-NxIkFO2-4-9j";
    let requestType = "출입 신청";

    

    function getTeacherByDay() {
        const days = ["일요일", "월요일", "화요일", "수요일", "목요일", "금요일", "토요일"];
        const teachers = {
            "일요일": "김동신",
            "월요일": "이동걸",
            "화요일": "양인석",
            "수요일": "김동신",
            "목요일": "이동걸",
            "금요일": "양인석",
            "토요일": "없음"
        };
        let today = new Date();
        return teachers[days[today.getDay()]];
    }

    function getRoleMention(teacher) {
        const roleMentions = {
            "김동신": "<@&1350654320739221545>",
            "이동걸": "<@&1350654434647998494>",
            "양인석": "<@&1350654515929415680>"
        };
        return roleMentions[teacher] || "";
    }

    document.querySelectorAll(".space-y-2 button").forEach(button => {
    button.addEventListener("click", function () {
        let now = new Date();
        dateInput.value = now.toISOString().split("T")[0];
        timeInput.value = now.toLocaleTimeString("ko-KR", { hour: "2-digit", minute: "2-digit", second: "2-digit" });
        teacherInput.value = getTeacherByDay();
        reasonInput.value = "";

        // requestType을 정확한 값으로 설정
        let rawType = this.parentElement.querySelector("span").innerText.trim();
        if (rawType.includes("외출")) {
            requestType = "외출";
        } else if (rawType.includes("외박")) {
            requestType = "외박";
        } else if (rawType.includes("조기")) {
            requestType = "조기";
        } else {
            requestType = "출입 신청";
        }

        popupTitle.innerText = requestType;
        console.log("선택된 신청 유형:", requestType); // 디버깅용 로그 추가
        popup.classList.remove("hidden");
    });
});


    closePopupBtn.addEventListener("click", function () {
        popup.classList.add("hidden");
    });

    submitBtn.addEventListener("click", function () {
        const loggedInUser = sessionStorage.getItem("loggedInUser") || "알 수 없음";
        const teacher = teacherInput.value;
        const roleMention = getRoleMention(teacher);
        const reason = reasonInput.value.trim();

        if (!reason) {
            reasonInput.classList.add("highlight");
            reasonInput.placeholder = "사유를 작성해주세요. 예) 개인사유";
            return;
        }

        reasonInput.classList.remove("highlight");

        const requestData = {
            username: "출입 신청 알림",
            avatar_url: "https://ifh.cc/g/gqo9gX.jpg",
            content: roleMention,
            embeds: [
                {
                    title: "📌 출입 신청 알림",
                    color: 0x3498db,
                    fields: [
                        { name: "📝 신청 유형", value: requestType, inline: false },
                        { name: "👤 신청자", value: loggedInUser, inline: false },
                        { name: "📅 날짜", value: dateInput.value, inline: false },
                        { name: "⏰ 제출 시간", value: timeInput.value, inline: false },
                        { name: "👨‍🏫 사감 선생님", value: teacher, inline: false },
                        { name: "📌 제출 사유", value: reason, inline: false }
                    ],
                    footer: {
                        text: "출입 관리 시스템 | 군산중앙고등학교",
                        icon_url: "https://ifh.cc/g/30Dsx9.png"
                    },
                    timestamp: new Date().toISOString()
                }
            ]
        };

        fetch(discordWebhookUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(requestData)
        })
        .then(response => {
            if (response.ok) {
                let customMessage = "";
                switch (requestType) {
                    case "외출":
                        customMessage = "외출 신청을 사감선생님께 전달했어요!";
                        break;
                    case "외박":
                        customMessage = "외박 신청을 사감선생님께 전달했어요!";
                        break;
                    case "조기":
                        customMessage = "조기퇴사 신청을 사감선생님께 전달했어요!";
                        break;
                    default:
                        customMessage = "출입 신청이 성공적으로 제출되었습니다.";
                }
                showCustomAlert(customMessage);
                popup.classList.add("hidden");
            } else {
                showCustomAlert("출입 신청 전송에 실패했습니다.");
            }
        })
        .catch(error => {
            console.error("전송 오류:", error);
            showCustomAlert("네트워크 오류가 발생했습니다.");
        });
    });

    function showCustomAlert(message) {
        const alertBox = document.getElementById("custom-alert");
        const alertMessage = document.getElementById("custom-alert-message");
        alertMessage.innerText = message;
        alertBox.classList.remove("hidden");
        setTimeout(() => {
            alertBox.classList.add("hidden");
        }, 3000);
    }
});

</script>
</body>
</head>


<body>

    <div id="overlay"></div>
    <div id="pc-popup">
        <p><strong>이 서비스는 모바일에서만 이용가능해요! PC에서는 이용할 수 없어요 😢</strong></p>
    </div>


<!-- 탐색하기 -->
<div class="bg-[#18181c] p-4 rounded-lg mb-4">
    <h2 class="text-lg font-semibold mb-3 flex items-center text-[#D9D9D9]">
        <i class="fas fa-compass mr-2"></i>
        탐색하기
    </h2>
    <div class="grid-container">
        <a href="#" class="grid-item" id="report-btn" data-key="report">
            <span class="bottom-text">고장신고 · <span class="last-click" id="last-click-report">-</span></span>
        </a>
        <a href="#" class="grid-item large" data-key="reading-room">
            <span class="bottom-text">열람실 · <span class="last-click" id="last-click-reading-room">-</span></span>
        </a>
        <a href="#" class="grid-item" id="meal-info-btn" data-key="meal-info">
            <span class="bottom-text">식단정보 · <span class="last-click" id="last-click-meal-info">-</span></span>
        </a>        
    </div>
</div>

<!-- 식단 팝업 -->
<div id="meal-popup" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center hidden">
    <div class="bg-[#1e1e22] p-5 rounded-2xl w-[340px] shadow-lg relative" id="meal-popup-content">
        <!-- 닫기(X) 버튼 -->
        <button id="close-meal-popup" class="absolute top-5 right-6 text-[#bfbfbf] hover:text-white transition">
           <i class="fa-solid fa-xmark"></i>
        </button>

        <h2 class="text-xl font-bold mb-4 text-[#D9D9D9] flex items-center">
            <i class="fas fa-utensils mr-2"></i> 오늘의 식단
        </h2>
        <div id="meal-content" class="text-[#BFBFBF] space-y-3">
            <div class="meal-section">
                <h3 class="meal-title"><i class="fas fa-sun"></i> 조식</h3>
                <p id="breakfast" class="meal-text">불러오는 중...</p>
            </div>
            <div class="meal-section">
                <h3 class="meal-title"><i class="fas fa-cloud-sun"></i> 중식</h3>
                <p id="lunch" class="meal-text">불러오는 중...</p>
            </div>
            <div class="meal-section">
                <h3 class="meal-title"><i class="fas fa-moon"></i> 석식</h3>
                <p id="dinner" class="meal-text">불러오는 중...</p>
            </div>
        </div>
    </div>
</div>



<!-- 고장 신고 팝업 -->
<div id="report-popup" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center hidden">
    <div class="bg-[#1e1e22] p-5 rounded-2xl w-[340px] shadow-lg relative" id="report-popup-content">
        <button id="close-report-popup" class="absolute top-5 right-6 text-[#bfbfbf] hover:text-white transition">
           <i class="fa-solid fa-xmark"></i>
        </button>

        <h2 class="text-xl font-bold mb-4 text-[#D9D9D9] flex items-center">
            <i class="fas fa-exclamation-triangle mr-2"></i> 고장 신고
        </h2>
        <select id="report-category" class="w-full p-2 bg-[#29292e] text-[#D9D9D9] rounded-md mb-3">
            <option value="">카테고리를 선택하세요</option>
            <option value="화장실">화장실</option>
            <option value="전기">전기</option>
            <option value="에어컨/난방">에어컨/난방</option>
            <option value="기타">기타</option>
        </select>
        <textarea id="report-text" class="w-full p-2 bg-[#29292e] text-[#D9D9D9] rounded-md hidden" rows="4" placeholder="고장 내용을 입력하세요"></textarea>
        <button id="submit-report" class="mt-3 bg-[#363740] text-white px-4 py-2 rounded-lg w-full hover:bg-[#2f3033] transition">신고하기</button>
    </div>
</div>

<!-- 자체 팝업 메시지 -->
<div id="custom-alert" class="fixed bottom-5 left-1/2 transform -translate-x-1/2 bg-[#29292e] text-white py-2 px-4 rounded-lg shadow-lg hidden flex items-center whitespace-nowrap overflow-hidden text-ellipsis">
    <i class="fa-regular fa-circle-check mr-2"></i>
    <span id="custom-alert-message">신고가 접수되었습니다.</span>
</div>




<!-- 공지사항 -->
<div class="bg-[#18181c] p-4 rounded-lg mb-4">
    <h2 class="text-lg font-semibold mb-4 flex items-center text-[#D9D9D9]">
        <i class="fas fa-newspaper mr-2"></i> 공지사항
    </h2>
    <ul id="notice-list" class="space-y-2">
        <li class="bg-[#1e1e22] p-3 rounded-lg flex justify-between items-center hover:bg-[#33323A] transition-all">
            <a href="#" class="flex justify-between w-full items-center">
                <span class="text-[#d4d4d8] text-sm font-medium">[공지사항] 군산중앙고등학교</span>
                <span class="text-[#A0A0A0] text-xs">2025.03.04</span>
            </a>
        </li>
        <li class="bg-[#1e1e22] p-3 rounded-lg flex justify-between items-center hover:bg-[#33323A] transition-all">
            <a href="#" class="flex justify-between w-full items-center">
                <span class="text-[#d4d4d8] text-sm font-medium">[공지사항] 신입생 안내사항</span>
                <span class="text-[#A0A0A0] text-xs">2025.03.04</span>
            </a>
        </li>
        <li class="bg-[#1e1e22] p-3 rounded-lg flex justify-between items-center hover:bg-[#33323A] transition-all">
            <a href="#" class="flex justify-between w-full items-center">
                <span class="text-[#d4d4d8] text-sm font-medium">[공지사항] 신입생 주의사항</span>
                <span class="text-[#A0A0A0] text-xs">2025.03.04</span>
            </a>
        </li>
    </ul>
</div>

<!-- 자체 팝업 메시지 -->
<div id="custom-alert" class="fixed bottom-5 left-1/2 transform -translate-x-1/2 bg-[#29292e] text-white py-2 px-4 rounded-lg shadow-lg hidden flex items-center whitespace-nowrap overflow-hidden text-ellipsis">
    <i class="fa-regular fa-circle-check mr-2"></i>
    <span id="custom-alert-message">신청이 성공적으로 접수되었습니다.</span>
</div>

<!-- 출입관리 -->
<div class="bg-[#18181c] p-4 rounded-lg mb-4">
    <h2 class="text-lg font-semibold mb-3 flex items-center text-[#D9D9D9]">
        <i class="fas fa-lock mr-2 text-gray-400"></i> 출입관리
    </h2>
    
    <!-- 신청 목록 -->
    <div class="space-y-2">
        <div class="bg-[#1e1e22] p-3 rounded-lg flex justify-between items-center">
            <span class="text-[#d4d4d8]">외출 신청</span>
            <button class="bg-[#363740] hover:bg-[#4a4b50] text-[#BFBFBF] px-4 py-2 rounded-lg transition-all">
                신청하기
            </button>
        </div>
        
        <div class="bg-[#1e1e22] p-3 rounded-lg flex justify-between items-center">
            <span class="text-[#d4d4d8]">외박 신청</span>
            <button class="bg-[#363740] hover:bg-[#4a4b50] text-[#BFBFBF] px-4 py-2 rounded-lg transition-all">
                신청하기
            </button>
        </div>
        
        <div class="bg-[#1e1e22] p-3 rounded-lg flex justify-between items-center">
            <span class="text-[#d4d4d8]">조기퇴소 신청</span>
            <button class="bg-[#363740] hover:bg-[#4a4b50] text-[#BFBFBF] px-4 py-2 rounded-lg transition-all">
                신청하기
            </button>
        </div>
    </div>
</div>

<!-- 출입 신청 팝업 -->
<div id="popup" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center hidden" onclick="closePopup(event)">
    <div class="bg-[#1e1e22] p-6 rounded-lg w-80 relative" onclick="event.stopPropagation();">
        <!-- 닫기(X) 버튼 -->
        <button id="closePopup" class="absolute top-6 right-3 text-[#bfbfbf] hover:text-white transition">
           <i class="fa-solid fa-xmark"></i>
        </button>
        <h2 id="popupTitle" class="text-lg font-semibold mb-4 text-[#D9D9D9] text-center">출입 신청</h2>
        
        <!-- 날짜 및 제출 시간 -->
        <div class="mb-3">
            <label class="text-sm text-[#BFBFBF]">오늘 날짜</label>
            <input id="date" type="text" class="w-full bg-[#2a2a2e] p-2 rounded text-[#D9D9D9]" readonly>
        </div>

        <div class="mb-3">
            <label class="text-sm text-[#BFBFBF]">제출 시간</label>
            <input id="time" type="text" class="w-full bg-[#2a2a2e] p-2 rounded text-[#D9D9D9]" readonly>
        </div>

        <!-- 담당 선생님 -->
        <div class="mb-3">
            <label class="text-sm text-[#BFBFBF]">금일 사감 선생님</label>
            <input id="teacher" type="text" class="w-full bg-[#2a2a2e] p-2 rounded text-[#D9D9D9]" readonly>
        </div>

        <!-- 제출 사유 입력 -->
        <div class="mb-4">
            <label class="text-sm text-[#BFBFBF]">제출 사유</label>
            <textarea id="reason" class="w-full bg-[#2a2a2e] p-2 rounded text-[#D9D9D9] rows="3" placeholder="사유를 작성해주세요. 예) 개인사유"></textarea>
        </div>

        <!-- 버튼 -->
        <div class="flex justify-center">
            <button id="submitRequest" class="bg-[#4a4b50] px-4 py-2 rounded text-white">제출하기</button>
        </div>
    </div>
</div>
 
<!-- 모바일 학생증 -->
<div class="bg-[#18181c] p-4 rounded-lg mb-4">
    <h2 class="text-lg font-semibold mb-3 flex items-center text-[#D9D9D9]">
        <i class="fas fa-id-card mr-2"></i> 모바일 학생증
    </h2>
    
    <!-- 학생증 카드 (앞면/뒷면) -->
    <div class="relative w-80 h-48 perspective-1000 mx-auto" onclick="flipCard()">
        <div id="studentCard" class="w-full h-full transition-transform duration-500 ease-in-out transform-style-preserve-3d">
            
            <!-- 앞면 -->
            <div class="absolute w-full h-full bg-[#1e1e22] rounded-xl shadow-lg flex items-center px-5 py-3 backface-hidden border border-[#33323A]">
                <img id="schoolLogo" src="https://taejun09.github.io/jungang/assets/image/jungang-main_logo.png" 
                     alt="학교 로고" class="w-14 h-14 rounded-full border-2 border-[#33323A] shadow-md">
                <div class="ml-4 text-left text-[#D9D9D9]">
                    <p id="studentName" class="text-lg font-semibold">이름</p>
                    <p id="studentID" class="text-sm text-[#A0A0A0]">학번: </p>
                    <p class="text-xs mt-1 text-[#7C7C7C]">중앙중학교</p>
                </div>
                <div class="ml-auto">
                    <img id="studentPhoto" src="https://randomuser.me/api/portraits/men/75.jpg" 
                         alt="학생 사진" class="w-16 h-16 rounded-lg border-2 border-[#33323A] shadow-md">
                </div>
            </div>

            <!-- 뒷면 -->
            <div class="absolute w-full h-full bg-[#1e1e22] rounded-xl shadow-lg flex flex-col items-center justify-center rotate-y-180 backface-hidden border border-[#33323A]">
                <p class="text-[#D9D9D9] text-sm font-semibold">발급 기관: 중앙중학교</p>
                <p class="text-[#A0A0A0] text-xs">유효기간: 2025년 2월 28일</p>
                <div class="bg-[#18181c] p-2 rounded-lg mt-3 border border-[#33323A]">
                    <img id="qrCode" src="" alt="QR 코드" class="w-20 h-20">
                </div>
                <p class="text-[#7C7C7C] text-xs mt-2">이 학생증은 본인 확인용입니다.</p>
            </div>
        </div>
    </div>
</div>

<script>
    let flipped = false;
    function flipCard() {
        flipped = !flipped;
        document.getElementById("studentCard").style.transform = flipped ? "rotateY(180deg)" : "rotateY(0deg)";
    }

    // 학생 정보 불러오기 및 반영
    document.addEventListener("DOMContentLoaded", function () {
    const name = sessionStorage.getItem("loggedInUser");
    const studentID = sessionStorage.getItem("studentID");
    const profileImage = sessionStorage.getItem("profileImage");

    if (name && studentID && profileImage) {
        document.getElementById("studentName").innerText = name;
        document.getElementById("studentID").innerText = `학번: ${studentID}`;
        document.getElementById("studentPhoto").src = profileImage;

        const token = Math.random().toString(36).substr(2, 10);
        localStorage.setItem("authToken", token);

        const qrURL = `https://taejun09.github.io/jungang/verify.html?studentID=${studentID}&token=${token}`;
        console.log("QR 코드 링크:", qrURL);
        document.getElementById("qrCode").src = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${qrURL}`;
    }
});
</script>


<style>
    .perspective-1000 {
        perspective: 1000px;
    }
    .transform-style-preserve-3d {
        transform-style: preserve-3d;
    }
    .backface-hidden {
        backface-visibility: hidden;
    }
    .rotate-y-180 {
        transform: rotateY(180deg);
    }
</style>
       <!-- 푸터 -->
<footer class="bg-[#18181c] p-4 rounded-lg">
    <div class="text-center text-gray-400 text-sm py-6">
        Copyright &copy; 2025 Taejun. All Rights Reserved.
    </div>
</footer>
</div>
</body>
</html>

