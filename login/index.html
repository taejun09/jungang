<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>êµ°ì‚°ì¤‘ì•™ê³ ë“±í•™êµ ê¸°ìˆ™ì‚¬ ë¡œê·¸ì¸</title>
    <link rel="icon" type="image/png" href="https://taejun09.github.io/jungang/assets/image/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/svg+xml" href="https://taejun09.github.io/jungang/assets/image/favicon.svg" />
<link rel="shortcut icon" href="https://taejun09.github.io/jungang/assets/image/favicon.ico" />
<link rel="apple-touch-icon" sizes="180x180" href="https://taejun09.github.io/jungang/assets/image/apple-touch-icon.png" />
<meta name="apple-mobile-web-app-title" content="êµ°ì‚°ì¤‘ì•™ê³  ê¸°ìˆ™ì‚¬" />
<link rel="manifest" href="https://taejun09.github.io/jungang/assets/image/site.webmanifest" />
<link href="jungang-login.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <!-- ë¡œê·¸ì¸ì°½ -->
    <img class="logo" src="https://ifh.cc/g/ttkYGN.png" alt="íšŒì‚¬ ë¡œê³ ">
    <div class="container" id="authContainer">
        <h2>ì¸ì¦í•˜ê¸°</h2>
        <p>ì´ë¦„ê³¼ ì„ ìƒë‹˜ê»˜ ë°œê¸‰ë°›ì€ 6ìë¦¬ ì ‘ì† ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>

        <input type="text" id="name" placeholder="ì´ë¦„ ì…ë ¥" maxlength="20">

        <input type="text" id="dob" placeholder="ì ‘ì† ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" maxlength="6">

        <button onclick="verifyDOB()">ì ‘ì†í•˜ê¸°</button>
    </div>
    
    <div class="footer">
        &copy; Copyright Â© 2025 Taejun. All Rights Reserved.
    </div>
</body>
</html>


<!-- ì˜¤ë¥˜ íŒì—…ì°½ -->
<div id="customAlert" class="custom-alert">
    <div class="custom-alert-content">
        <p id="alertMessage"></p>
        <button onclick="closeCustomAlert()">í™•ì¸</button>
    </div>
</div>

<script>
    async function verifyDOB() {
        const inputDOB = document.getElementById("dob").value.trim();
        const inputName = document.getElementById("name").value.trim();
    
        try {
            const response = await fetch("https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLglGrRAgk0WeMYmdIPAmpcWUWMuAOUwy3dszIm1qj_LUJWVOGtma7nSToxIb2WzNzSlUl_6ckqLxw98vz6POz0RHppVMUOW_HHnfxEGlUA8hl63dXe9dA8hLXVZODrOlQYpB58tZ4sTpPmvrJNSvTKS5Li381eZU-Ocga9Ip82eqYdxhfMczu9e38fNPnGz1KjRHOPN7xLBIx31LxtQy62Yz3rLD1x4bg67MSDG3zhxgBjBLMHrtfH2OCdtAaHRlxhmJd5m84XCMuv_PTLm4mzMj8_Tmg&lib=MIiTwKlDuBdmMmEehkb8j16Kr128tNxL1");
            const validPasswords = await response.json();
    
            console.log("API ì‘ë‹µ ë°ì´í„°:", validPasswords); // ğŸ›  ì›ë³¸ ë°ì´í„° í™•ì¸
    
            const validData = validPasswords
                .map(entry => {
                    const authCode = entry.authCode ? String(entry.authCode).trim() : null;
                    const userName = entry.userName ? String(entry.userName).trim() : null;
                    const studentID = entry.studentID ? String(entry.studentID).trim() : null; // í•™ë²ˆ
                    const profileImage = entry.profileImage ? String(entry.profileImage).trim() : null; // í”„ë¡œí•„ ì´ë¯¸ì§€
    
                    return authCode && userName ? { code: authCode, name: userName, id: studentID, image: profileImage } : null;
                })
                .filter(entry => entry !== null);
    
            console.log("ê°€ê³µëœ ë°ì´í„°:", validData); // ğŸ›  ê°€ê³µëœ ë°ì´í„° í™•ì¸
    
            const matchedEntry = validData.find(entry => entry.code === inputDOB && entry.name === inputName);
    
            if (matchedEntry) {
                console.log("ë§¤ì¹­ëœ ì‚¬ìš©ì:", matchedEntry); // ğŸ›  ë§¤ì¹­ëœ ì‚¬ìš©ì í™•ì¸
    
                sessionStorage.setItem("loggedInUser", matchedEntry.name);
                sessionStorage.setItem("studentID", matchedEntry.id);
                sessionStorage.setItem("profileImage", matchedEntry.image);
    
                window.location.href = "http://127.0.0.1:5500/index.html";
            } else {
                showCustomAlert("ì…ë ¥í•˜ì‹  ì¸ì¦ì½”ë“œë‚˜ ì´ë¦„ì´ í‹€ë¦° ê²ƒ ê°™ì•„ìš”! <br> ë‹¤ì‹œ í•œ ë²ˆ í™•ì¸í•´ ì£¼ì„¸ìš”.");
            }
        } catch (error) {
            console.error("ì¸ì¦ì„œë²„ API ì˜¤ë¥˜:", error);
            showCustomAlert("ì„œë²„ ì˜¤ë¥˜! ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
        }
    }

        

// ì»¤ìŠ¤í…€ íŒì—… í•¨ìˆ˜
function showCustomAlert(message) {
    document.getElementById("alertMessage").innerHTML = message;
    document.getElementById("customAlert").style.display = "flex";
}

function closeCustomAlert() {
    document.getElementById("customAlert").style.display = "none";
}

</script>